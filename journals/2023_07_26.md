- # Originヘッダについて
- [Originヘッダ](https://developer.mozilla.org/ja/docs/Web/HTTP/Headers/Origin)
- 異なるオリジンへのリクエストをJavaScriptで送信する時に、ブラウザが自動で送信元のオリジンをOriginヘッダとして付与してからリクエストを送信する
	- ブラウザが自動でつけるHTTPヘッダは他にもあって、[Hostヘッダ](https://developer.mozilla.org/ja/docs/Web/HTTP/Headers/Host)とか[Referrerヘッダ](https://developer.mozilla.org/ja/docs/Web/HTTP/Headers/Referer)とかがある
	- 例えば、http://example.comからhttp://localhost:3000にリクエストを飛ばす場合は、http://example.comとhttp://localhost:3000は異なるオリジンだから、Originヘッダはhttp://example.comになる(http://example.comとhttp://localhost:3000を選んだのには特に理由はない)
		- http://example.com を開いて、Consoleにfetch("http://localhost:3000")と入力する
		- fetch("http://example.com")の場合は、Originヘッダがついていないことを確認する
	- formタグでリクエストを送信する時はOriginヘッダはつかない
		- formタグは同一生成元ポリシーの制限を受けないため、Originヘッダを送信する必要がない？
		- そもそも同一生成元ポリシーの制限を受けるとは？JavaScriptで結果を読み出すことが出来ないということ？
- なんでOriginヘッダを送信するのかというと、CORSのため
	- サーバ側で許可しているオリジンの中にOriginヘッダがあればリソースを渡すし、なかったら渡さない
	- 大抵のWebフレームワークには↑の処理をしてくれる機能がある
		- Ginの場合は[gin-contrib / cors](https://github.com/gin-contrib/cors)
		- Originヘッダの値がcors.allowOriginsの中にあるかをチェックしている
		- GinのMiddlewareはNextで次のハンドラを呼び出すことが出来るが、[ここの処理](https://github.com/gin-contrib/cors/blob/master/cors.go#L163-L168)でNextを呼んでないのはなぜ?
			- Nextは、ハンドラの後にMiddlewareで処理を実行したい時に使う
				- ハンドラの前にトランザクションを張って、ハンドラの処理結果に基づいて、ロールバックするかを決めたい時など
			- Nextが無くても、自動的に後続のハンドラを実行してくれるようになっている
- # Misc
- Goのdeferはなんである？なくても良くない？
	- ファイルをCloseするような処理を書き忘れないようにするため
	- 「ファイルをOpenした行の後に、deferでCloseする処理を書いておく」という決まりがあれば忘れにくい
	- [Goのdeferの仕組みをきちんと理解する - Qiita](https://qiita.com/kohekohe1221/items/fb11a3572251f31c5ae5)
	- [ファイルの読み書き｜Goから学ぶI/O](https://zenn.dev/hsaki/books/golang-io-package/viewer/file)