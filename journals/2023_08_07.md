- # 暗号技術入門
- ## 第14章 SSL/TLS(続き)
- ### SSL/TLSへの攻撃
	- 個々の暗号技術への攻撃
		- SSL/TLSで使われている暗号技術に対する攻撃は、そのままSSL/TLSへの攻撃になる
		- しかし、SSL/TLSは特定の暗号技術に依存していないため、脆弱なことが判明した暗号技術を使わないような暗号スイートに切り替えれば良い
	- OpenSSLのHeartBleed脆弱性
		- TLSのハートビート拡張という機能に要求データサイズのチェックが抜けていたため、メモリ上の無関係な情報まで相手に返してしまうというもの
	- POODLE攻撃
		- SSL3.0におけるパディングオラクル攻撃
		- ある条件下の通信ではTLSを使っていてもSSL3.0にダウングレードさせられ、POODLE攻撃を受ける危険性がある
	- FREAK攻撃
		- Factoring RSA Export Keys (輸出用RSA鍵の素因数分解) の略(Aがないが英語のfreakに語呂合わせしている)
		- SSL/TLSサーバにRSA Export Suitesという弱い暗号スイートを使わせる攻撃
			- アメリカは暗号を武器と考え、1990年代後半まで、強い暗号ソフトウェアの輸出を禁じていた
			- RSA Export Suitesはその時代でも利用できるように故意に弱くした暗号スイートで512ビットのRSAや40ビットのDESを使っている
		- FREAK攻撃が実現するには、脆弱性を持ったSSL/TLSサーバと、RSA Export Suitesを受け入れてしまうWebブラウザ(HTTPクライアント)の両方が必要
- ## 付録 楕円曲線暗号
- ### 楕円曲線暗号とは
	- 楕円曲線はRSAに比べて短い鍵で同じだけの強さを持つ
		- 224~255ビット長の鍵を持つ楕円曲線暗号は、2048ビット長の鍵を持つRSAとほぼ同等の強さを持つ
	- 楕円曲線のグラフは楕円形になるわけではない
	- 一般に楕円曲線とは、$$ y^2 = ax^3 + bx^2 + cx + d $$ で表される曲線(ただし、$$a \neq 0$$ で $$ ax^3 + bx^2 + cx + d = 0 $$は重解を持たないとする)
		- x軸に対称なグラフ
- ### 楕円曲線上の演算
	- 楕円曲線上の2点A, Bを通る直線を考え、この直線と楕円曲線のAとB以外の交点を求めて、これをx軸に関して対称の位置に移動した点をA+Bと定義する(楕円曲線上の加算)
		- A+Aのような場合は、Aで接する直線を考える
	- Aをx軸に関して対称の位置に移動した点を-Aと定義する(楕円曲線上の符号反転演算)
		- Aと-Aを通る直線は、Aと-A以外に交点を持たない
		- このような場合は、「無限遠点」で交わっているものとする
			- 無限遠点はOと呼び、0のような役割を持つ(A+(-A)=Oであるため)
- ### 楕円曲線上の離散対数問題
	- 入力 : 楕円曲線E, E上の点G, E上の点xG
	- 出力 : x
	- 楕円曲線暗号では、楕円曲線上の離散対数問題の難しさを利用する
- ### 楕円曲線Diffie-Hellman鍵交換
	- 手順
		- AliceとBobの間で点Gを共有する
			- Gは盗聴者に知られても良い
			- GはPの生成元というもので、G<P
		- Aliceは乱数aを用意、Bobは乱数bを用意する
			- aはAliceだけの秘密、bはBobだけの秘密にする
		- AliceはBobに対してaG、BobはAliceに対してbGを送信する
			- この値は盗聴者に知られても良い
		- Aliceは受け取った値(bG)をa倍して、Bobは受け取った値(aG)をb倍する
			- これによってAliceとBobは共通鍵(abG)を手に入れることが出来た
	- 厳密には、楕円曲線上の離散対数問題の難しさは、G, aG, bGからaやbを求めるのが難しいことを言っているのであって、abGを計算することが難しいとは言っていないため、別の議論が必要
- ### 楕円曲線ElGamal暗号
	- 楕円曲線diffie-Hellman鍵交換におけるa, bをAliceの秘密鍵、Bobの秘密鍵とし、aG, bGをAliceの公開鍵、Bobの公開鍵と考える
	- 暗号化
		- AliceはBobに送りたいメッセージを楕円曲線上の点Mとして表現する(点のx座標を使う)
		- Aliceの秘密鍵とBobの公開鍵から、M+abGを計算してBobに送信する
	- 復号化
		- Aliceの公開鍵とBobの秘密鍵から、abGを計算して、Aliceから受信したM+abGから引いて、メッセージMを得る
- ### 楕円曲線DSA(ECDSA)
	- 楕円曲線暗号を使ったデジタル署名
	- デジタル署名の作成
		- Aliceは乱数rからrG=(x, y)を求める
		- 乱数rとメッセージmのハッシュ値hとAliceの秘密鍵aからs=(h+ax)/rを計算し、BobにmとrGとsを送る(rGとsがデジタル署名になる)
	- デジタル署名の検証
		- 受け取ったメッセージmからハッシュ値hを計算する
		- (h/S)G+(x/s)(aG)を計算してrGと比較する
	- 同じメッセージに対して署名する場合でも、乱数rを変えれば異なるデジタル署名が作られる